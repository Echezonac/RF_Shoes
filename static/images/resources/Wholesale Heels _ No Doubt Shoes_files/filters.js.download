function Loader(t){t}const endpoint="https://www.nodoubtshoes.com/api/2020-10/graphql.json";const gl_token="ee60d86e3300569ecad5364a1f8b1bd9";var productFilters={};var appliedFilter={};var filteredProducts=[];var lastFilter;var pageInx=1;var productCards;const perpage=32;function loader(t){t?$(".loader").show():$(".loader").hide()}function FetchData(t,e){fetch(endpoint,{async:!0,crossDomain:!0,method:"POST",headers:{"X-Shopify-Storefront-Access-Token":gl_token,"Content-Type":"application/graphql"},body:t}).then((t=>t.json())).then((t=>{e(t)}))}var productsForFilter;function getCollectionData(t){FetchData(`query {\ncollectionByHandle(handle: "${collectionHandle}") {\n      products( first: 250) {\n        edges{\n\t\t  cursor\n          node {\n            id\n            metafields (first: 20){\n              edges{\n                node{\n\t\t\t\t  value\n\t\t\t\t  key\n              }\n            }\n          }\n        }\n      }  \n    }\n  }\n}`,(function(e){productsForFilter=[];const a=e.data.collectionByHandle.products.edges;for(let t of a){var o={id:t.node.id};for(let e of t.node.metafields.edges)o[e.node.key]=e.node.value;productsForFilter.push(o)}t.apply()}))}function getAllDataGQL(t){FetchData(`query {\n\tshop {\n      products( first: 250) {\n        edges{\n\t\t  cursor\n          node {\n            id\n            metafields (first: 20){\n              edges{\n                node{\n\t\t\t\t  value\n\t\t\t\t  key\n              }\n            }\n          }\n        }\n      }  \n    }\n  }\n}`,(function(e){productsForFilter=[];const a=e.data.shop.products.edges;for(let t of a){var o={id:t.node.id};for(let e of t.node.metafields.edges)o[e.node.key]=e.node.value;productsForFilter.push(o)}t.apply()}))}var _sortProducts=[];function getCollectionDataSort(t,e,a){var o;FetchData(o="all"==collectionHandle?`query {\nshop {\n      products( first: 250,sortKey:${t}) {\n        edges{\n          node {\n            id\n            \n        }\n      }  \n    }\n  }\n}\n`:`query {\ncollectionByHandle(handle: "${collectionHandle}") {\nproducts( first: 250,sortKey:${t}) {\n        edges{\t\t  \n          node {\n            id            \n          }\n        }\n      }  \n    }\n  }\n`,(function(t){var a;_sortProducts=[],a="all"==collectionHandle?t.data.shop.products.edges:t.data.collectionByHandle.products.edges;for(let t of a)_sortProducts.push(t.node.id);e&&(_sortProducts=_sortProducts.reverse()),showProducts(),$(window).width()>599?($(".filter-sort__title").next().removeClass("filter-sort__list--active"),$(".filter-sort__title").next().slideUp(150),$(".filter-sort__title").removeClass("filter-sort__title--active")):($(".filter-sort__list").removeClass("filter-sort__list--active"),$(".filter-sort-overlay").removeClass("filter-sort-overlay--active"),$("html").removeClass("no-scroll"))}))}function getAllData(t,e){$.ajax({method:"GET",url:document.location.origin+document.location.pathname+"/?view=json"+(null!=e?"&page="+e:""),success:function(a){var o=a.replace(/\n/g,"").replace(/,}/g,"}").replace(/,]/g,"]");if(""!=o.replace(/ /g,"")){var i=JSON.parse(o).products;for(let t of i){var r={};for(const[e,a]of Object.entries(t))r[e]="id"==e?window.btoa("gid://shopify/Product/"+a):a;productsForFilter.push(r)}getAllData(t,null!=e?e+1:2)}else t.apply()}})}function getDataProducts(t){FetchData(`query {\n\t\tnodes(ids: ${JSON.stringify(t)}) {\n\t\t...on Product {\n\t\t\tid\n\t\t\ttitle\n\t\t\thandle\n\t\t\tvariants(first:10) {\n      \t\t\tedges\n      \t\t\t{\n        \t   \t\tnode {\n          \t\t\t\tcompareAtPrice\n          \t\t\t\tprice\n          \t\t\t\tavailableForSale\n          \t\t\t\tsku\t\t\n\t\t\t\t\t\tquantityAvailable\n        \t\t\t}\n      \t\t\t}\n    \t\t}\n            images(first: 1) {\n              edges {\n                node {\n                  originalSrc\n                  altText\n                }\n              }\n            }\n\t\t}\n\t}\n\t}`,(function(t){console.log(t)}))}function getMetaProducts(t,e,a){FetchData(`query {\n\t\tnodes(ids: ${JSON.stringify(t)}) {\n\t\t...on Product {\n\t\t\tid\n            metafields (first: 20){\n              edges{\n                node{\n\t\t\t\t  value\n\t\t\t\t  key\n              }\n            }\n\t\t}\n\t}\n}}`,(function(t){t.data.nodes.forEach((t=>{var a=window.atob(t.id).replace("gid://shopify/Product/","");var o=t.metafields.edges.filter((t=>"preorder_date_available"==t.node.key));o.length>0&&e.items.forEach((t=>{t.product_id==a&&(t.available=o[0].node.value)}))})),a.apply(e)}))}function buildUI(){var t;var e;productFilter={},$("[data-filter]").each((function(){var t=$(this).data("filter");var e={};for(let o of productsForFilter)if(null!=o[t]){var a=o[t]+"";-1!=a.indexOf("|")?a.split("|").forEach((t=>e[t]=null!=e[t]?e[t]+1:1)):e[a]=null!=e[a]?e[a]+1:1}if(0==Object.keys(e).length)$(this).remove();else{var o=$(this).find(".filter__list");o.empty();for(const[t,a]of Object.entries(e))o.append(`<div class="filter__item" data-filter-value="${t}">${t}<span class="filter__count">(${a})</span></div>`)}productFilters[t]=e})),$("[data-filter] .filter__item").click((function(){applyFilter(this)})),productsForFilter.length>perpage?($('[data-container="loadmore"]').show(),$('[data-container="loadmore-summary"]').text("You've viewed "+perpage+" of "+productsForFilter.length+" products"),$('[data-container="loadmore-percentage"] span').css("width",parseInt(100*perpage/productsForFilter.length)+"%")):$('[data-container="loadmore"]').hide(),$.each(document.location.search.substring(1).split("&"),(function(){"page_m"==this.split("=")[0]&&(e=this.split("=")[1]),"scrollto"==this.split("=")[0]&&(t=this.split("=")[1])})),null!=e&&(pageInx=parseInt(e),showProducts(!1,(function(){null!=t&&this==t&&$("html, body").scrollTop($('[data-product="'+t+'"]').offset().top)})))}function applyFilter(t){var e=$(t).closest("[data-filter]").data("filter");var a=$(t).data("filter-value");null!=appliedFilter[e]&&appliedFilter[e].includes(a)?(appliedFilter[e]=appliedFilter[e].filter((t=>t!==a)),$(t).removeClass("filter__item--active"),$(`[data-filter-apply='${e}|${a}']`).remove(),$(window).width()<600&&$("html,body").scrollTop(0),showProducts(!0)):(appliedFilter[e]=appliedFilter[e]||[],appliedFilter[e].push(a),lastFilter=e,$(t).addClass("filter__item--active"),$(window).width()<600&&$("html,body").scrollTop(0),showProducts()),$("[data-filter-apply]").off("click").on("click",(function(){var t=$(this).data("filter-apply").split("|");appliedFilter[t[0]]=appliedFilter[t[0]].filter((e=>e!==t[1])),$(`[data-filter="${t[0]}"] [data-filter-value="${t[1]}"]`).removeClass("filter__item--active"),$(this).remove(),showProducts(!0)})),pageInx=1,$.each(document.location.search.substring(1).split("&"),(function(){if("page_m"==this.split("=")[0]){const t={Page:document.location.pathname,Url:"?page_m=1"};history.pushState(t,t.Page,t.Url)}}))}function showProducts(t,e){$("[data-filter]").removeClass("filter__group--selected"),$(".filter__title").removeClass("filter__title--selected"),$(".filter-refine__title").removeClass("filter-refine__title--selected");for(const[t,e]of Object.entries(appliedFilter))e.length>0&&($(`[data-filter="${t}"]`).addClass("filter__group--selected"),$(`[data-filter="${t}"] .filter__title`).addClass("filter__title--selected"),$(".filter-refine__title").addClass("filter-refine__title--selected")),e.forEach((e=>{0==$(`[data-filter-apply='${t}|${e}']`).length&&$('[data-action="clearfilter"]').before(`<div class='filter-tags__tag' data-filter-apply='${t}|${e}'>${e}<i class='fa fal-times'></i></div>`)}));filteredProducts=[],productsForFilter.forEach((t=>{var e=!0;for(const[a,o]of Object.entries(appliedFilter))if(o.length>0)if(null!=t[a]&&-1!=t[a].indexOf("|")){if(0==o.filter((e=>t[a].split("|").filter((t=>t==e)).length>0)).length){e=!1;break}}else if(0==o.filter((e=>e===t[a])).length){e=!1;break}e&&filteredProducts.push(t.id)}));const a=productsForFilter.filter((t=>filteredProducts.includes(t.id)));$("[data-filter]").each((function(){const t=this;const e=$(this).data("filter");const o=a.filter((t=>null!=t[e]));$("[data-filter-value]",this).each((function(){const t=$(this).data("filter-value");var a=o.filter((a=>a[e].split("|").filter((e=>e==t)).length>0)).length;0==a?e!=lastFilter&&($(this).addClass("filter__item--disabled"),$(this).find(".filter__count").text("("+a+")")):(e!=lastFilter||$(this).hasClass("filter__item--disabled"))&&($(this).removeClass("filter__item--disabled"),$(this).find(".filter__count").text("("+a+")"))}))})),$("[data-filter-apply]").length>0?$('[data-action="clearfilter"]').show():$('[data-action="clearfilter"]').hide(),renderProducts(e)}function renderProducts(t){var e;e=0==_sortProducts.length?filteredProducts.map((t=>t)).slice(0,perpage*pageInx):filteredProducts.sort(((t,e)=>_sortProducts.indexOf(t)>_sortProducts.indexOf(e)?1:-1)).slice(0,perpage*pageInx),$("[data-product]").filter(((t,a)=>!e.includes(window.btoa("gid://shopify/Product/"+a.dataset.product)))).each((function(){$(this).hide()})),$("[data-product]").filter(((t,a)=>e.includes(window.btoa("gid://shopify/Product/"+a.dataset.product)))).sort(((t,a)=>e.indexOf(window.btoa("gid://shopify/Product/"+t.dataset.product))>e.indexOf(window.btoa("gid://shopify/Product/"+a.dataset.product))?1:-1)).appendTo(".wrap--full.wrap .row").each((function(){$(this).attr("data-pos",e.indexOf(window.btoa("gid://shopify/Product/"+this.dataset.product)))}));const a=$("[data-product]").get(0).className;const o=e.filter((t=>0==$(`[data-product="${window.atob(t).replace("gid://shopify/Product/","")}"]`).length));o.length>0&&loader(!0);var i=0;o.length>0?$('[data-container="loadmore"]').css("opacity",0):($("[data-product]").filter(((t,a)=>e.includes(window.btoa("gid://shopify/Product/"+a.dataset.product)))).sort(((t,a)=>e.indexOf(window.btoa("gid://shopify/Product/"+t.dataset.product))>e.indexOf(window.btoa("gid://shopify/Product/"+a.dataset.product))?1:-1)).appendTo(".wrap--full.wrap .row").each((function(){$(this).show()})),filteredProducts.length>pageInx*perpage?($('[data-container="loadmore"]').show(),$('[data-container="loadmore-summary"]').text("You've viewed "+pageInx*perpage+" of "+filteredProducts.length+" products"),$('[data-container="loadmore-percentage"] span').css("width",parseInt(100*pageInx*perpage/filteredProducts.length)+"%"),$('[data-container="loadmore"]').css("opacity",1)):$('[data-container="loadmore"]').hide()),o.forEach((r=>{var n=productsForFilter.filter((t=>t.id===r))[0];if(null!=n){const l=window.atob(n.id).replace("gid://shopify/Product/","");const d=e.indexOf(r);$.ajax({method:"GET",url:document.location.origin+"/products/"+n.handle+"/?view=card",success:function(r){if(0==$(`[data-product="${l}"]`).length){var n=$(r);n.get(0).className=a,n.attr("data-pos",d),n.hide(),$(".wrap--full.wrap .row").append(n),initSwatches(),linkProductScroll(),t&&t.apply(l+"")}var s;++i>=o.length&&(loader(!1),$("[data-product]").filter(((t,a)=>e.includes(window.btoa("gid://shopify/Product/"+a.dataset.product)))).sort(((t,a)=>e.indexOf(window.btoa("gid://shopify/Product/"+t.dataset.product))>e.indexOf(window.btoa("gid://shopify/Product/"+a.dataset.product))?1:-1)).appendTo(".wrap--full.wrap .row").each((function(){$(this).show()})),filteredProducts.length>pageInx*perpage?($('[data-container="loadmore"]').show(),$('[data-container="loadmore-summary"]').text("You've viewed "+pageInx*perpage+" of "+filteredProducts.length+" products"),$('[data-container="loadmore-percentage"] span').css("width",parseInt(100*pageInx*perpage/filteredProducts.length)+"%"),$('[data-container="loadmore"]').css("opacity",1)):$('[data-container="loadmore"]').hide(),$.each(document.location.search.substring(1).split("&"),(function(){"scrollto"==this.split("=")[0]&&(s=this.split("=")[1])})),null!=s&&$("html, body").scrollTop($('[data-product="'+s+'"]').offset().top))}})}}))}function linkProductScroll(){$("[data-product]").off("click").on("click",(function(){if(history&&null!=history.state||$("[data-product]").length>perpage){var t={Page:document.location.pathname,Url:"?page_m="+pageInx+"&scrollto="+$(this).data("product")};history.replaceState(t,t.Page,t.Url)}}))}window.onpopstate=function(t){var e=1;$.each(document.location.search.substring(1).split("&"),(function(){"page_m"==this.split("=")[0]&&(e=parseInt(this.split("=")[1]))})),e!=pageInx&&(pageInx=e,showProducts())},$(document).ready((function(){productsForFilter=[],null!=window.collectionHandle&&""!=window.collectionHandle&&(getAllData(buildUI),linkProductScroll(),$('[data-action="clearfilter"]').click((function(){$("[data-filter-apply]").remove(),$(".filter__item--active").removeClass("filter__item--active"),appliedFilter=[],lastFilter=0,pageInx=1,$.each(document.location.search.substring(1).split("&"),(function(){if("page_m"==this.split("=")[0]){const t={Page:document.location.pathname,Url:"?page_m=1"};history.pushState(t,t.Page,t.Url)}})),showProducts(!0)})),$('[data-action="loadmore"]').click((function(){pageInx+=1;const t={Page:document.location.pathname,Url:"?page_m="+pageInx};history.pushState(t,t.Page,t.Url),showProducts()}))),$(".filter-sort__item").length>0&&$(".filter-sort__item").click((function(){$(".filter-sort__item").not(this).removeClass("filter-sort__item--active"),$(this).addClass("filter-sort__item--active"),$(".filter-sort__title").text($(this).text());var t="TITLE";var e=!1;switch($(this).attr("value")){case"best-selling":t="BEST_SELLING";break;case"title-ascending":t="TITLE";break;case"title-descending":t="TITLE",e=!0;break;case"price-ascending":t="PRICE";break;case"price-descending":t="PRICE",e=!0;break;case"created-ascending":t="CREATED";break;case"created-descending":t="CREATED",e=!0;break;case"manual":t="MANUAL";break}getCollectionDataSort(t,e)}))}));
//# sourceMappingURL=/s/files/1/0505/7442/6300/t/5/assets/filters.js.map?v=14449215246828305130
